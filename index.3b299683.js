async function t(t,e){try{const a=await fetch(t+"?"+new URLSearchParams(e));return await a.json()}catch(t){console.error(t)}}const e=document.querySelector(".movies__list");async function a(a){try{e.innerHTML="";const n=await async function(){try{return(await t("https://api.themoviedb.org/3/genre/movie/list",{api_key:"1d9e7558ae558dc94a5fda2c9843c8eb",language:"en-US"})).genres}catch(t){console.error(t)}}();a.forEach((t=>{const a=function(t,e){const a=[];return t.genre_ids.forEach((t=>{for(const n of e)t===n.id&&a.push(n.name)})),a}(t,n);!function(t,a){let n,o;n=null===t.poster_path?"https://europix.cc/no-poster.png":`https://image.tmdb.org/t/p/w500${t.poster_path}`,o=0===a.length?["Unknown"]:a;let s=`<li class="movie" data-id="${t.id}">\n        <img class="movie__img"\n          src=${n}\n          alt="${t.title} poster." loading="lazy" />\n        <h2 class="movie__title">${t.title}</h2>\n        <div class="movie__info">\n          <p class="movie__detail">\n            ${o.slice(0,4).join(", ")}\n          </p>\n          <p class="movie__detail">|</p>\n          <p class="movie__detail">${t.release_date.slice(0,4)}</>\n        </div>\n      </li>`;e.insertAdjacentHTML("beforeend",s)}(t,a)}))}catch(t){console.error(t)}}const n=document.querySelector(".pagination");function o(t,e){const a=document.createElement("button");a.setAttribute("type","button"),a.textContent=t,a.classList.add("pagination__button"),a.classList.add("pagination__button--actual"),n.append(a);const o=document.createElement("button");o.setAttribute("type","button"),o.classList.add("pagination__button"),o.textContent=t+1;const s=document.createElement("button");s.setAttribute("type","button"),s.classList.add("pagination__button"),s.textContent=t+2;const d=document.createElement("button");d.setAttribute("type","button"),d.classList.add("pagination__button"),d.textContent=t-1;const i=document.createElement("button");i.setAttribute("type","button"),i.classList.add("pagination__button"),i.textContent=t-2;const l=document.createElement("button");l.setAttribute("type","button"),l.classList.add("pagination__button"),l.classList.add("pagination__button--next"),l.dataset.page=t+1;const r=document.createElement("button");r.setAttribute("type","button"),r.classList.add("pagination__button"),r.classList.add("pagination__button--previous"),r.dataset.page=t-1;const c=document.createElement("button");c.setAttribute("type","button"),c.textContent=1,c.classList.add("pagination__button"),c.classList.add("pagination__button--hideAbility");const u=document.createElement("button");u.setAttribute("type","button"),u.textContent=e,u.classList.add("pagination__button"),u.classList.add("pagination__button--hideAbility");const _=document.createElement("button");_.setAttribute("type","button"),_.textContent="...",_.classList.add("pagination__button"),_.classList.add("pagination__button--hideAbility"),_.classList.add("pagination__button--deactive");const m=document.createElement("button");m.setAttribute("type","button"),m.textContent="...",m.classList.add("pagination__button"),m.classList.add("pagination__button--hideAbility"),m.classList.add("pagination__button--deactive"),1===t&&(e>t&&n.append(o),e>o.textContent&&n.append(s),e>s.textContent&&(n.append(_),n.append(u)),e>t&&n.append(l)),2===t&&(e>t&&n.append(o),e>o.textContent&&n.append(s),e>s.textContent&&(n.append(_),n.append(u)),e>t&&n.append(l),n.prepend(d),n.prepend(r)),t>2&&(e>t&&n.append(o),e>o.textContent&&n.append(s),e>s.textContent&&(n.append(_),n.append(u)),e>t&&n.append(l),n.prepend(d),n.prepend(i),t>3&&(n.prepend(m),n.prepend(c)),n.prepend(r))}function s(){n.replaceChildren()}const d=(t,e)=>{const a=l(e);a&&window.localStorage.setItem(a,JSON.stringify(t))},i=t=>{const e=l(t);if(!e)return;const a=window.localStorage.getItem(e);return JSON.parse(a)},l=t=>"watched"===t?"movies-watched":"queue"===t?"movies-queue":(console.error("wronga type key in localStorage"),!1),r={setItem:d,getItem:i,removeItem:(t,e)=>{if(!l(e))return;const a=i(e);if(!a)return;const n=a.filter(((e,a)=>e!==t));d(n,e)}},c=document.querySelector("#loader"),u=document.querySelector("body");let _;const m=()=>{_=t=>{u.style.cursor="none",c.style.left=`${t.clientX}px`,c.style.top=`${t.clientY}px`,c.style.display="block"},document.addEventListener("mousemove",_)},p=()=>{u.style.cursor="auto",document.removeEventListener("mousemove",_),c.style.display="none"},b=document.querySelector(".overlay"),v=(document.querySelector(".modal__window"),document.querySelector(".modal__button-close")),g=document.querySelector(".modal__movie");let h={watched:null,queue:null};const y=t=>"UL"!==t.tagName&&("LI"!==t.tagName?y(t.parentElement):t),L=t=>{"Escape"!==t.key&&27!==t.keyCode||f(!1)},w=t=>{t.currentTarget===t.target&&f(!1)},f=t=>{if(t)return b.classList.remove("overlay--is-hidden"),void b.classList.add("noscroll");b.classList.remove("noscroll"),b.classList.add("overlay--is-hidden"),h.watched.removeEventListener("click",q),h.queue.removeEventListener("click",q),window.removeEventListener("keyup",L),b.removeEventListener("click",w)},q=(t,e)=>{const a=r.getItem(e);let n,o=[];if(a&&(o=[...a]),o.includes(t))return r.removeItem(t,e),h[e].classList.remove(`modal-movie__${e}`),void(h[e].innerText=`Add to ${e}`);o.push(t),r.setItem(o,e),"watched"===e&&(n="queue"),"queue"===e&&(n="watched"),r.removeItem(t,n),h[e].classList.add(`modal-movie__${e}`),h[e].innerText=`Remove from ${e}`,h[n].classList.remove(`modal-movie__${n}`),h[n].innerText=`Add to ${n}`},$=document.querySelector(".search__button"),E=document.querySelector(".search__input"),S=document.querySelector(".pagination"),x=document.querySelector(".movies"),k=document.querySelector(".movies__list");let A=1;window.onload=()=>{m(),setTimeout((()=>{t("https://api.themoviedb.org/3/trending/movie/day",{api_key:"1d9e7558ae558dc94a5fda2c9843c8eb",page:A}).then((t=>{p(),s(),A=t.page,a(t.results),o(t.page,t.total_pages)}))}),0)},$.addEventListener("click",(e=>{e.preventDefault(),m(),A=1,x.dataset.searchquery=E.value,t("https://api.themoviedb.org/3/search/movie",{api_key:"1d9e7558ae558dc94a5fda2c9843c8eb",language:"en-US",query:E.value,include_adult:!1,page:A}).then((t=>{0===t.total_results&&document.querySelector(".header__error").classList.remove("header__error--hidden"),p(),s(),A=t.page,a(t.results),t.total_results>0&&(document.querySelector(".header__error").classList.add("header__error--hidden"),o(t.page,t.total_pages))})),""!=E.value&&(E.value="")})),S.addEventListener("click",(e=>{e.preventDefault,m(),e.target.classList.contains("pagination__button")&&((e.target.classList.contains("pagination__button--next")||e.target.classList.contains("pagination__button--previous"))&&(A=e.target.dataset.page),""!==e.target.textContent&&(A=e.target.textContent)),e.target.classList.contains("pagination__button")&&(window.scrollTo(0,0),void 0===x.dataset.searchquery&&t("https://api.themoviedb.org/3/trending/movie/day",{api_key:"1d9e7558ae558dc94a5fda2c9843c8eb",page:A}).then((t=>{p(),s(),A=t.page,a(t.results),o(t.page,t.total_pages)})),void 0!==x.dataset.searchquery&&(t("https://api.themoviedb.org/3/search/movie",{api_key:"1d9e7558ae558dc94a5fda2c9843c8eb",language:"en-US",query:x.dataset.searchquery,include_adult:!1,page:A}).then((t=>{0===t.total_results&&document.querySelector(".header__error").classList.remove("header__error--hidden"),p(),s(),A=t.page,a(t.results),t.total_results>0&&(document.querySelector(".header__error").classList.add("header__error--hidden"),o(t.page,t.total_pages))})),""!=E.value&&(E.value="")))})),k.addEventListener("click",(async e=>{if(m(),e.target===e.currentTarget)return;const a=y(e.target);if(!a)return;const n=a.dataset.id,o=await t(`https://api.themoviedb.org/3/movie/${n}`,{api_key:"1d9e7558ae558dc94a5fda2c9843c8eb",language:"en-US"});if(!1===o.success)return;const s=r.getItem("watched"),d=r.getItem("queue");let i,l,c="",u="",_="Add to watched",v="Add to queue";s&&s.includes(n)&&(c="modal-movie__watched",_="Remove from watched"),d&&d.includes(n)&&(u="modal-movie__queue",v="Remove from queue"),i=null===o.poster_path?"https://europix.cc/no-poster.png":`https://image.tmdb.org/t/p/w500${o.poster_path}`,l=0===o.genres.length?["Unknown"]:o.genres.map((t=>t.name)).join(", ");const $=`\n                <div class="modal-movie__container">\n                  <img src=${i}\n                    alt="${o.title} poster." class="modal-movie__picture" />\n                  <div class="modal-movie__information">\n                    <h3 class="modal-movie__title">${o.title}</h3>\n                    <table>\n                      <tbody class="modal-movie__table modal-table">\n                        <tr class="modal-table__row">\n                          <td class="modal-table__data modal-table__title">Vote/Votes</td>\n                          <td class="modal-table__data modal-table__information">\n                            <span class="modal-table__number modal-table--orange">\n                              ${Math.round(10*o.vote_average)/10}\n                            </span> / \n                            <span class="modal-table__number modal-table--grey">\n                              ${o.vote_count}\n                            </span>\n                          </td>\n                        </tr>\n                        <tr class="modal-table__row">\n                          <td class="modal-table__data modal-table__title">Popularity</td>\n                          <td class="modal-table__data modal-table__information">\n                            ${Math.round(10*o.popularity)/10}\n                          </td>\n                        </tr>\n                        <tr class="modal-table__row">\n                          <td class="modal-table__data modal-table__title">Original Title</td>\n                          <td class="modal-table__data modal-table__information modal-table--uppercase">\n                            ${o.original_title}\n                          </td>\n                        </tr>\n                        <tr class="modal-table__row">\n                          <td class="modal-table__data modal-table__title">Genre</td>\n                          <td class="modal-table__data modal-table__information">\n                            ${l}\n                          </td>\n                        </tr>\n                      </tbody>\n                    </table>\n                    <div class="modal-movie__overview">\n                      <h4 class="modal-movie__about">About</h4>\n                      <p class="modal-movie__description">\n                        ${o.overview}\n                      </p>\n                    </div>\n                    <div class="modal-movie__buttons movie-button">\n                      <button\n                        type="button"\n                        class="modal-movie__btn ${c}"\n                        data-idfilm=""\n                        data-btn="watched">\n                          ${_}\n                      </button>\n                      <button\n                        type="button"\n                        class="modal-movie__btn ${u}"\n                        data-idfilm=""\n                        data-btn="queue">\n                          ${v}\n                      </button>\n                    </div>\n                  </div>\n                </div>`;g.innerHTML=$,f(!0),window.addEventListener("keyup",L),b.addEventListener("click",w),h.watched=document.querySelector('[data-btn="watched"]'),h.queue=document.querySelector('[data-btn="queue"]'),h.watched.addEventListener("click",(t=>q(n,"watched"))),h.queue.addEventListener("click",(t=>q(n,"queue"))),p()})),v.addEventListener("click",(t=>f(!1)));
//# sourceMappingURL=index.3b299683.js.map
