async function t(t,e){try{const n=await fetch(t+"?"+new URLSearchParams(e));return await n.json()}catch(t){console.error(t)}}const e=document.querySelector(".movies__list");async function n(n){try{e.innerHTML="";const a=await async function(){try{return(await t("https://api.themoviedb.org/3/genre/movie/list",{api_key:"1d9e7558ae558dc94a5fda2c9843c8eb",language:"en-US"})).genres}catch(t){console.error(t)}}();n.forEach((t=>{const n=function(t,e){const n=[];return t.genre_ids.forEach((t=>{for(const a of e)t===a.id&&n.push(a.name)})),n}(t,a);!function(t,n){let a,o;a=null===t.poster_path?"https://europix.cc/no-poster.png":`https://image.tmdb.org/t/p/w500${t.poster_path}`,o=0===n.length?["Unknown"]:n;let s=`<li class="movie" data-id="${t.id}">\n        <img class="movie__img"\n          src=${a}\n          alt="${t.title} poster." loading="lazy" />\n        <h2 class="movie__title">${t.title}</h2>\n        <div class="movie__info">\n          <p class="movie__detail">\n            ${o.slice(0,4).join(", ")}\n          </p>\n          <p class="movie__detail">|</p>\n          <p class="movie__detail">${t.release_date.slice(0,4)}</>\n        </div>\n      </li>`;e.insertAdjacentHTML("beforeend",s)}(t,n)}))}catch(t){console.error(t)}}const a=document.querySelector(".pagination");function o(t,e){const n=document.createElement("button");n.setAttribute("type","button"),n.textContent=t,n.classList.add("pagination__button"),n.classList.add("pagination__button--actual"),a.append(n);const o=document.createElement("button");o.setAttribute("type","button"),o.classList.add("pagination__button"),o.textContent=t+1;const s=document.createElement("button");s.setAttribute("type","button"),s.classList.add("pagination__button"),s.textContent=t+2;const d=document.createElement("button");d.setAttribute("type","button"),d.classList.add("pagination__button"),d.textContent=t-1;const i=document.createElement("button");i.setAttribute("type","button"),i.classList.add("pagination__button"),i.textContent=t-2;const l=document.createElement("button");l.setAttribute("type","button"),l.classList.add("pagination__button"),l.classList.add("pagination__button--next"),l.dataset.page=t+1;const r=document.createElement("button");r.setAttribute("type","button"),r.classList.add("pagination__button"),r.classList.add("pagination__button--previous"),r.dataset.page=t-1;const c=document.createElement("button");c.setAttribute("type","button"),c.textContent=1,c.classList.add("pagination__button"),c.classList.add("pagination__button--hideAbility");const u=document.createElement("button");u.setAttribute("type","button"),u.textContent=e,u.classList.add("pagination__button"),u.classList.add("pagination__button--hideAbility");const _=document.createElement("button");_.setAttribute("type","button"),_.textContent="...",_.classList.add("pagination__button"),_.classList.add("pagination__button--hideAbility"),_.classList.add("pagination__button--deactive");const m=document.createElement("button");m.setAttribute("type","button"),m.textContent="...",m.classList.add("pagination__button"),m.classList.add("pagination__button--hideAbility"),m.classList.add("pagination__button--deactive"),1===t&&(e>t&&a.append(o),e>o.textContent&&a.append(s),e>s.textContent&&(a.append(_),a.append(u)),e>t&&a.append(l)),2===t&&(e>t&&a.append(o),e>o.textContent&&a.append(s),e>s.textContent&&(a.append(_),a.append(u)),e>t&&a.append(l),a.prepend(d),a.prepend(r)),t>2&&(e>t&&a.append(o),e>o.textContent&&a.append(s),e>s.textContent&&(a.append(_),a.append(u)),e>t&&a.append(l),a.prepend(d),a.prepend(i),t>3&&(a.prepend(m),a.prepend(c)),a.prepend(r))}function s(){a.replaceChildren()}const d=(t,e)=>{const n=l(e);n&&window.localStorage.setItem(n,JSON.stringify(t))},i=t=>{const e=l(t);if(!e)return;const n=window.localStorage.getItem(e);return JSON.parse(n)},l=t=>"watched"===t?"movies-watched":"queue"===t?"movies-queue":(console.error("wronga type key in localStorage"),!1),r={setItem:d,getItem:i,removeItem:(t,e)=>{if(!l(e))return;const n=i(e);if(!n)return;const a=n.filter(((e,n)=>e!==t));d(a,e)}},c=document.querySelector("#loader"),u=document.querySelector("body");let _;const m=()=>{_=t=>{u.style.cursor="none",c.style.left=`${t.clientX}px`,c.style.top=`${t.clientY}px`,c.style.display="block"},document.addEventListener("mousemove",_)},p=()=>{u.style.cursor="auto",document.removeEventListener("mousemove",_),c.style.display="none"},b=document.querySelector("body"),v=document.querySelector(".overlay"),g=(document.querySelector(".modal__window"),document.querySelector(".modal__button-close")),h=document.querySelector(".modal__movie");let y={watched:null,queue:null};const L=t=>"UL"!==t.tagName&&("LI"!==t.tagName?L(t.parentElement):t),w=t=>{"Escape"!==t.key&&27!==t.keyCode||q(!1)},f=t=>{t.currentTarget===t.target&&q(!1)},q=t=>{if(t)return b.classList.add("noScroll"),void v.classList.remove("overlay--is-hidden");b.classList.remove("noScroll"),v.classList.add("overlay--is-hidden"),y.watched.removeEventListener("click",S),y.queue.removeEventListener("click",S),window.removeEventListener("keyup",w),v.removeEventListener("click",f)},S=(t,e)=>{const n=r.getItem(e);let a,o=[];if(n&&(o=[...n]),o.includes(t))return r.removeItem(t,e),y[e].classList.remove(`modal-movie__${e}`),void(y[e].innerText=`Add to ${e}`);o.push(t),r.setItem(o,e),"watched"===e&&(a="queue"),"queue"===e&&(a="watched"),r.removeItem(t,a),y[e].classList.add(`modal-movie__${e}`),y[e].innerText=`Remove from ${e}`,y[a].classList.remove(`modal-movie__${a}`),y[a].innerText=`Add to ${a}`},$=document.querySelector(".search__button"),E=document.querySelector(".search__input"),x=document.querySelector(".pagination"),k=document.querySelector(".movies"),A=document.querySelector(".movies__list");let C=1;window.onload=()=>{m(),setTimeout((()=>{t("https://api.themoviedb.org/3/trending/movie/day",{api_key:"1d9e7558ae558dc94a5fda2c9843c8eb",page:C}).then((t=>{p(),s(),C=t.page,n(t.results),o(t.page,t.total_pages)}))}),0)},$.addEventListener("click",(e=>{e.preventDefault(),m(),C=1,k.dataset.searchquery=E.value,t("https://api.themoviedb.org/3/search/movie",{api_key:"1d9e7558ae558dc94a5fda2c9843c8eb",language:"en-US",query:E.value,include_adult:!1,page:C}).then((t=>{0===t.total_results&&document.querySelector(".header__error").classList.remove("header__error--hidden"),p(),s(),C=t.page,n(t.results),t.total_results>0&&(document.querySelector(".header__error").classList.add("header__error--hidden"),o(t.page,t.total_pages))})),""!=E.value&&(E.value="")})),x.addEventListener("click",(e=>{e.preventDefault,m(),e.target.classList.contains("pagination__button")&&((e.target.classList.contains("pagination__button--next")||e.target.classList.contains("pagination__button--previous"))&&(C=e.target.dataset.page),""!==e.target.textContent&&(C=e.target.textContent)),e.target.classList.contains("pagination__button")&&(window.scrollTo(0,0),void 0===k.dataset.searchquery&&t("https://api.themoviedb.org/3/trending/movie/day",{api_key:"1d9e7558ae558dc94a5fda2c9843c8eb",page:C}).then((t=>{p(),s(),C=t.page,n(t.results),o(t.page,t.total_pages)})),void 0!==k.dataset.searchquery&&(t("https://api.themoviedb.org/3/search/movie",{api_key:"1d9e7558ae558dc94a5fda2c9843c8eb",language:"en-US",query:k.dataset.searchquery,include_adult:!1,page:C}).then((t=>{0===t.total_results&&document.querySelector(".header__error").classList.remove("header__error--hidden"),p(),s(),C=t.page,n(t.results),t.total_results>0&&(document.querySelector(".header__error").classList.add("header__error--hidden"),o(t.page,t.total_pages))})),""!=E.value&&(E.value="")))})),A.addEventListener("click",(async e=>{if(m(),e.target===e.currentTarget)return;const n=L(e.target);if(!n)return;const a=n.dataset.id,o=await t(`https://api.themoviedb.org/3/movie/${a}`,{api_key:"1d9e7558ae558dc94a5fda2c9843c8eb",language:"en-US"});if(!1===o.success)return;const s=r.getItem("watched"),d=r.getItem("queue");let i,l,c="",u="",_="Add to watched",b="Add to queue";s&&s.includes(a)&&(c="modal-movie__watched",_="Remove from watched"),d&&d.includes(a)&&(u="modal-movie__queue",b="Remove from queue"),i=null===o.poster_path?"https://europix.cc/no-poster.png":`https://image.tmdb.org/t/p/w500${o.poster_path}`,l=0===o.genres.length?["Unknown"]:o.genres.map((t=>t.name)).join(", ");const g=`\n                <div class="modal-movie__container">\n                  <img src=${i}\n                    alt="${o.title} poster." class="modal-movie__picture" />\n                  <div class="modal-movie__information">\n                    <h3 class="modal-movie__title">${o.title}</h3>\n                    <table>\n                      <tbody class="modal-movie__table modal-table">\n                        <tr class="modal-table__row">\n                          <td class="modal-table__data modal-table__title">Vote/Votes</td>\n                          <td class="modal-table__data modal-table__information">\n                            <span class="modal-table__number modal-table--orange">\n                              ${Math.round(10*o.vote_average)/10}\n                            </span> / \n                            <span class="modal-table__number modal-table--grey">\n                              ${o.vote_count}\n                            </span>\n                          </td>\n                        </tr>\n                        <tr class="modal-table__row">\n                          <td class="modal-table__data modal-table__title">Popularity</td>\n                          <td class="modal-table__data modal-table__information">\n                            ${Math.round(10*o.popularity)/10}\n                          </td>\n                        </tr>\n                        <tr class="modal-table__row">\n                          <td class="modal-table__data modal-table__title">Original Title</td>\n                          <td class="modal-table__data modal-table__information modal-table--uppercase">\n                            ${o.original_title}\n                          </td>\n                        </tr>\n                        <tr class="modal-table__row">\n                          <td class="modal-table__data modal-table__title">Genre</td>\n                          <td class="modal-table__data modal-table__information">\n                            ${l}\n                          </td>\n                        </tr>\n                      </tbody>\n                    </table>\n                    <div class="modal-movie__overview">\n                      <h4 class="modal-movie__about">About</h4>\n                      <p class="modal-movie__description">\n                        ${o.overview}\n                      </p>\n                    </div>\n                    <div class="modal-movie__buttons movie-button">\n                      <button\n                        type="button"\n                        class="modal-movie__btn ${c}"\n                        data-idfilm=""\n                        data-btn="watched">\n                          ${_}\n                      </button>\n                      <button\n                        type="button"\n                        class="modal-movie__btn ${u}"\n                        data-idfilm=""\n                        data-btn="queue">\n                          ${b}\n                      </button>\n                    </div>\n                  </div>\n                </div>`;h.innerHTML=g,q(!0),window.addEventListener("keyup",w),v.addEventListener("click",f),y.watched=document.querySelector('[data-btn="watched"]'),y.queue=document.querySelector('[data-btn="queue"]'),y.watched.addEventListener("click",(t=>S(a,"watched"))),y.queue.addEventListener("click",(t=>S(a,"queue"))),p()})),g.addEventListener("click",(t=>q(!1)));
//# sourceMappingURL=index.bc2faa3c.js.map
